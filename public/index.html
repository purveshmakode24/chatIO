<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon"
          href="img/logo.jpg">

    <title>Omeclone</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <!-- Custom styles for this template -->

    <style>
        /** Globals */

        /* Links */
        a,
        a:focus,
        a:hover {
            color: #fff;
        }

        /* Custom default button */
        .btn-secondary,
        .btn-secondary:hover,
        .btn-secondary:focus {
            color: #333;
            text-shadow: none; /* Prevent inheritance from `body` */
            background-color: #fff;
            border: .05rem solid #fff;
        }

        /*
         * Base structure
         */

        html,
        body {
            height: 100%;
            /*background-color: #333;*/
        }

        body {
            display: -ms-flexbox;
            display: flex;
            color: #fff;
            text-shadow: 0 .05rem .1rem rgba(0, 0, 0, .5);
            box-shadow: inset 0 0 5rem rgba(0, 0, 0, .5);
            background-image: url("img/background.jpg");
        }

        .cover-container {
            max-width: 42em;
        }

        /*
         * Header
         */
        .masthead {
            margin-bottom: 2rem;
        }

        .masthead-brand {
            margin-bottom: 0;
        }

        .nav-masthead .nav-link {
            padding: .25rem 0;
            font-weight: 700;
            color: rgba(255, 255, 255, .5);
            background-color: transparent;
            border-bottom: .25rem solid transparent;
        }

        .nav-masthead .nav-link:hover,
        .nav-masthead .nav-link:focus {
            border-bottom-color: rgba(255, 255, 255, .25);
        }

        .nav-masthead .nav-link + .nav-link {
            margin-left: 1rem;
        }

        .nav-masthead .active {
            color: #fff;
            border-bottom-color: #fff;
        }

        @media (min-width: 48em) {
            .masthead-brand {
                float: left;
            }

            .nav-masthead {
                float: right;
            }
        }

        /*
         * Cover
         */
        .cover {
            padding: 0 1.5rem;
        }

        .cover .btn-lg {
            padding: .75rem 1.25rem;
            font-weight: 700;
        }

        /*
         * Footer
         */
        .mastfoot {
            color: rgba(255, 255, 255, .5);
        }

        /* CUSTOM CSS*/

         #chatWindow {
   
            max-height: 490px;
            width: 60vw;
            overflow: auto;
        }
  
        #main {
            display: none;
        }

        #name {
            border: 1px #ccc solid;
            border-radius: 10px;
            padding: 10px 10px 10px 10px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #18222C;
            min-width: 270px;
        }

        input {
            height: 30px;
        }

        #error {
            background: #FF9494;
            margin-bottom: 10px;
            font-size: small;
        }

        .lead {
            font-size: 19px;
            padding-left: 15px;
            padding-right: 15px;
        }

		.forusersautoflow {
			overflow: auto;
    		max-height: 482px;
		}

        @media(max-width: 550px) {
        	.lead {
        		font-size: 15px;
        		padding-left: 2px;
            	padding-right: 2px;
        }
        	}

        	.cover-heading {
        		font-size: 2.0rem;
        		padding-bottom: 10px;
        	}
        }

    </style>

 <style class="cp-pen-styles">* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Nunito', sans-serif;
}

html, body {
 /* background: -webkit-linear-gradient(330deg, #000, #f0a6ca);*/
  /*background: linear-gradient(120deg, #000, #f0a6ca);*/
  overflow: hidden;
}

.container {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
  -ms-flex-pack: center;
  justify-content: center;
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
  -ms-flex-direction: column;
  flex-direction: column;
  height: 80vh;
  width: 10vw;
}

.container h1 {
  color: #FFF;
  text-align: center;
}

.chatbox {
  /*background: rgba(255, 255, 255, 0.05);*/
  background:rgb(2 3 12 / 72%);
  /*width: 600px;*/
  width: 80vw;
  /*height: 75%;*/
  min-height: 528px;
  max-height: 535px;
  border-radius: 0.2em;
  position: relative;
  box-shadow: 1px 1px 12px rgba(0, 0, 0, 0.1);
}


.chatbox__messages:nth-of-type(odd) .chatbox__messages__user-message--ind-message {
  float: right;
}

.chatbox__messages:nth-of-type(odd) .chatbox__messages__user-message--ind-message:after {
  content: '';
  position: absolute;
  margin: -1.5em -17.06em;
  width: 0;
  height: 0;
  border-top: 10px solid transparent;
  border-bottom: 10px solid transparent;
  border-right: 10px solid rgba(255, 255, 255, 0.2);
}

.chatbox__messages__user-message {
  width: 450px;
}

.chatbox__messages__user-message--ind-message {
  background: rgba(255, 255, 255, 0.2);
  padding: 0.7em 0;
  height: auto;
  width: 65%;
  border-radius: 5px;
  margin: 1em 1em;
  overflow: auto;
}

.chatbox__messages__user-message--ind-message > p.name {
  color: #FFF;
  font-size: 1em;
}

.chatbox__messages__user-message--ind-message > p.message {
  color: #FFF;
  font-size: 0.7em;
  margin: 0 2.8em;
}

.chatbox__user-list {
  /*background: rgba(255, 255, 255, 0.1);*/
  background: #010113ad;
  width: 25%;
  height: 100%;
  float: right;
  border-top-right-radius: 0.2em;
  border-bottom-right-radius: 0.2em;
/*  overflow: auto;*/
}

.chatbox__user-list h1 {
  background: rgba(255, 255, 255, 0.05);
  color: rgba(255, 255, 255, 0.9);
  font-size: 0.9em;
  padding: 1em;
  margin: 0;
  font-weight: 300;
  text-align: center;
}

.chatbox__user, .chatbox__user--active, .chatbox__user--busy, .chatbox__user--away {
  width: 0.5em;
  height: 0.5em;
  border-radius: 100%;
  margin: 1em 0.7em;
}

.chatbox__user--active {
  background: rgba(23, 190, 187, 0.8);
}

.chatbox__user--busy {
  background: rgba(252, 100, 113, 0.8);
}

.chatbox__user--away {
  background: rgba(255, 253, 130, 0.8);
}

.chatbox p {
  float: left;
  text-align: left;
  margin: -0.25em 2em;
  font-size: 0.7em;
  font-weight: 300;
  color: #FFF;
 /* width: 200px;*/
}

.chatbox form {
  background: #222;
}

.chatbox form input {
  /*background: rgba(255, 255, 255, 0.03);*/
  background: rgb(68 71 82 / 47%);
  position: absolute;
  bottom: 0;
  left: 0;
  border: none;
  width: 75%;
  padding: 1.2em;
  outline: none;
  color: rgba(255, 255, 255, 0.9);
  font-weight: 300;
}

::-webkit-input-placeholder {
  color: rgba(255, 255, 255, 0.9);
}

:-moz-placeholder {
  color: rgba(255, 255, 255, 0.9);
}

::-moz-placeholder {
  color: rgba(255, 255, 255, 0.9);
}

:-ms-input-placeholder {
  color: rgba(255, 255, 255, 0.9);
}

   	@media(max-width: 560px){
		#user h1 {
		    font-size: 12px;
		    } 
		}

	@media(max-width: 506px){
		#user h1 {
		    font-size: 10px;
		    }   
		}	

	 @media(max-width: 361px) and (max-height: 641px) {
        #chatWindow {
	        max-height: 368px;
	        width: 60vw;
	        overflow: auto;
	    
        }

		.chatbox {
			/*background: rgba(255, 255, 255, 0.05);*/
			background:rgb(2 3 12 / 72%);
			/*width: 600px;*/
	     	width: 80vw;
		    /*height: 75%;*/
			min-height: 410px;
			max-height: 410px;
			border-radius: 0.2em;
			position: relative;
			box-shadow: 1px 1px 12px rgba(0, 0, 0, 0.1);
		}	

		.forusersautoflow {
			overflow: auto;
	   		max-height: 360px;
		}

    }


</style>


</head>

<body class="text-center">
<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="masthead mb-auto">
    </header>
    <main role="main" class="inner cover container1">
        <div id="name">
            <br>
            <h1 class="cover-heading">OMECLONE</h1>
            <p class="lead">Let's Start Instant Messaging. Chat Room for Active Users.<br> <span
                    style="font-size: small; color: yellow">No Registration, Stay
                Anonymous!</span></p>
            <form id="usernameForm">
                <div class="form-group">
                    <div class="col-md-12 pt-2">
                        <label style="font-size: 20px">Create Username</label>
                        <div id="error"></div>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">@</span>
                            </div>
                            <input type="text" class="form-control" id="username"
                                   placeholder="Username"
                                   aria-describedby="inputGroupPrepend2" required="" maxlength="14"
                                   oninvalid="this.setCustomValidity('Please Enter Your Username')"
                                   oninput="setCustomValidity('')">
                        </div>
                        <div style="margin-bottom: 12px"></div>
                        <button type="submit" class="btn btn-lg btn-secondary" style="padding: 5px">Submit</button>
                    </div>
                </div>
            </form>
        </div>
        <div id="main">

        	<div class='container' ng-cloak ng-app="chatApp">
			 <h1 class="cover-heading">OMECLONE</h1>
			 <br>
			  <div id="chat" class='chatbox' ng-controller="MessageCtrl as chatMessage">
			    <div id="user" class='chatbox__user-list'>
			      	<h1 class="online_users">Online Users</h1>
			      	<div class="forusersautoflow">   	
				     	<div id="users">    
				  		</div>	
				  	</div>	
			    </div>
			    <div class="chatbox__messages">
			      <div id="chatWindow" class="chatbox__messages__user-message">
			        
			      </div>

			    </div>
			    <form id="messageForm" name="form1">
                    <div>
                        <input type="text" id="message" placeholder="Type a message.. (Enter to submit)" required=""
                               oninvalid="this.setCustomValidity('Please type a message..')"
                               oninput="setCustomValidity('')">  
                    </div>

                </form>
			  </div>
        </div>
    </main>
    <br>
    <br>
    <footer class="mastfoot mt-auto foot">
        <small>
            <div class="inner" style="color: white">
                &copy; 2018 Omeclone | P.M.
            </div>
        </small>
    </footer>
</div>

<script src="https://code.jquery.com/jquery-latest.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    //scroll to the bottom in every 5000 interval
    window.setInterval(function () {
        var elem = document.getElementById('chatWindow');
        elem.scrollTop = elem.scrollHeight;
    }, 5000);

    $(function () {
        var socket = io.connect();
        var $messageForm = $('#messageForm');
        var $message = $('#message');
        var $chat = $('#chatWindow');
        var $usernameForm = $('#usernameForm');
        var $users = $('#users')
        var $username = $('#username');
        var $error = $('#error');

        $usernameForm.submit(function (e) {
            e.preventDefault();
            socket.emit('new user', $username.val(), function (data) {

                if (data) {
                    $('#name').hide();
                    $('#main').show();
                } else {
                    $error.html('<p style="color: red;">Username is already taken</p>');
                }
            });
            $username.val('');
        });

        socket.on('usernames', function (data) {
            var html = "";
            for (i = 0; i < data.length; i++) {
                html += "<div class='chatbox__user--active'><p>"+data[i]+"</p></div>";
            }
            $users.html(html);
        })

        $messageForm.submit(function (e) {
            e.preventDefault();
            socket.emit('send message', $message.val());
            $message.val('');
        });

        function formatAMPM(date) {
		  var hours = date.getHours();
		  var minutes = date.getMinutes();
		  var ampm = hours >= 12 ? 'pm' : 'am';
		  hours = hours % 12;
		  hours = hours ? hours : 12; // the hour '0' should be '12'
		  minutes = minutes < 10 ? '0'+minutes : minutes;
		  var strTime = hours + ':' + minutes + ' ' + ampm;
		  return strTime;
		}

        socket.on('new message', function (data) {
            $chat.append('<div class="chatbox__messages__user-message--ind-message"><p class="name"><strong>'+data.user+':</strong></p><br/><p class="message float-left">'+data.msg +'</p><br/><p class="float-right">'+formatAMPM(new Date) +'</p></div>');
        });
    })
</script>
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery-slim.min.js"><\/script>')</script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</body>
</html>









